<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reflexive Symmetrical Architecture (RSA) | An Interactive Exploration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Futuristic Dark (Background: #0D1117, Text: #C9D1D9, Accent: #22d3ee - Cyan) -->
    <!-- Application Structure Plan: A multi-section, single-page application designed for interactive learning. A sticky navigation bar allows users to jump to different sections: 1. A 'Theory' section with a clickable accordion to explore core concepts without being overwhelmed by text. 2. A central 'Model' section featuring an interactive RRA calculator. Users input market data, and the application instantly calculates all RRA levels and visualizes them on a dynamic Chart.js chart, making the mathematical model tangible. 3. A 'Synthesis' section uses clickable cards to explain the archetypal setups, showing the practical application. 4. A 'Framework' section uses a CSS-based diagram to visually represent the time hierarchy. This structure transforms the dense whitepaper from a static document into an engaging educational tool. -->
    <!-- Visualization & Content Choices: Core concepts are presented in a JS-powered accordion to manage text density. The mathematical formulas are brought to life with an interactive calculator (HTML inputs, JS logic) and a Chart.js line chart for visualization, which is the most effective way to show the spatial relationships of the RRA levels. The synthesis archetypes are presented in clickable cards for focused explanations. The time hierarchy is visualized using a semantic HTML/CSS pyramid for instant clarity. All choices prioritize interaction and understanding over static presentation. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        :root {
            --bg-color: #0D1117;
            --text-primary: #C9D1D9;
            --text-secondary: #8B949E;
            --border-color: #30363d;
            --accent-color: #22d3ee;
            --accent-hover: #67e8f9;
            --card-bg: #161B22;
        }
        body {
            font-family: 'Roboto Mono', monospace;
            background-color: var(--bg-color);
            color: var(--text-primary);
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Exo 2', sans-serif;
            letter-spacing: 0.05em;
        }
        .nav-link {
            transition: color 0.3s ease, border-color 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover, .nav-link.active {
            color: var(--accent-color);
            border-color: var(--accent-color);
        }
        .lang-btn.active {
            background-color: var(--accent-color);
            color: #0D1117;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 500px;
            }
        }
        .structure-btn.active {
             border-color: var(--accent-color);
             box-shadow: 0 0 15px rgba(34, 211, 238, 0.3);
        }
        .structure-btn.active h4 {
            color: var(--accent-color);
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header & Navigation -->
    <header id="header" class="bg-black/30 backdrop-blur-lg sticky top-0 z-50 border-b border-[var(--border-color)]">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-2xl md:text-3xl font-bold">
                <a href="#"><span class="text-[var(--accent-color)]">R</span>SA</a>
            </h1>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#introduction" class="nav-link font-medium pb-1" data-lang-key="navIntro">Introduction</a>
                <a href="#theory" class="nav-link font-medium pb-1" data-lang-key="navTheory">The Theory</a>
                <a href="#model" class="nav-link font-medium pb-1" data-lang-key="navModel">The Model</a>
                <a href="#synthesis" class="nav-link font-medium pb-1" data-lang-key="navSynthesis">The Synthesis</a>
                <a href="#framework" class="nav-link font-medium pb-1" data-lang-key="navFramework">The Framework</a>
                <a href="#tools" class="nav-link font-medium pb-1" data-lang-key="navTools">Tools</a>
                <a href="#whitepaper" class="nav-link font-medium pb-1" data-lang-key="navWhitepaper">Whitepaper</a>
                <div id="lang-switcher" class="flex items-center border border-[var(--border-color)] rounded-full p-0.5">
                    <button class="lang-btn text-xs font-semibold px-3 py-1 rounded-full" data-lang="en">EN</button>
                    <button class="lang-btn text-xs font-semibold px-3 py-1 rounded-full" data-lang="id">ID</button>
                </div>
            </div>
            <div class="md:hidden flex items-center">
                 <div id="lang-switcher-mobile" class="flex items-center border border-[var(--border-color)] rounded-full p-0.5 mr-2">
                    <button class="lang-btn text-xs font-semibold px-2 py-0.5 rounded-full" data-lang="en">EN</button>
                    <button class="lang-btn text-xs font-semibold px-2 py-0.5 rounded-full" data-lang="id">ID</button>
                </div>
                <select id="mobile-nav" class="bg-[var(--card-bg)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]">
                </select>
            </div>
        </nav>
    </header>

    <main>
        <!-- Hero Section -->
        <section id="hero" class="py-24 md:py-40 text-center relative overflow-hidden">
             <div class="absolute inset-0 bg-grid-pattern opacity-10"></div>
            <div class="container mx-auto px-6 relative">
                <h2 class="text-4xl md:text-6xl font-bold leading-tight uppercase" data-lang-key="heroTitle">Reflexive Symmetrical Architecture</h2>
                <p class="mt-4 text-lg md:text-xl text-[var(--text-secondary)] max-w-3xl mx-auto" data-lang-key="heroSubtitle">A unified theory of price-time, built on the first principle of recursive binary division.</p>
                <h3 class="mt-8 text-xl text-[var(--accent-color)]" data-lang-key="heroAuthor">By Adiyat Coto</h3>
            </div>
        </section>
        
        <!-- Introduction Section -->
        <section id="introduction" class="py-16 md:py-24">
             <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h3 class="text-3xl font-bold" data-lang-key="introTitle">An Introduction to RSA</h3>
                </div>
                <div id="intro-content-container" data-lang-key="introContent" class="max-w-4xl mx-auto text-lg space-y-8 text-left leading-relaxed text-[var(--text-secondary)]">
                     <!-- Intro content injected by JS -->
                </div>
            </div>
        </section>

        <!-- The Theory Section -->
        <section id="theory" class="py-16 md:py-24 bg-[var(--card-bg)] border-y border-[var(--border-color)]">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h3 class="text-3xl font-bold" data-lang-key="theoryTitle">The Theory</h3>
                    <div data-lang-key="theoryIntro">
                        <p class="mt-4 text-lg text-[var(--text-secondary)] max-w-3xl mx-auto">This section details the core components of the RSA framework. Explore each concept to understand the mechanics behind the model.</p>
                    </div>
                </div>
                <div class="max-w-4xl mx-auto">
                    <div id="accordion-container" class="space-y-4">
                        <!-- Accordion Items will be injected by JS -->
                    </div>
                </div>
            </div>
        </section>

        <!-- The Model Section -->
        <section id="model" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h3 class="text-3xl font-bold" data-lang-key="modelTitle">The RRA Model</h3>
                    <p class="mt-2 text-[var(--text-secondary)]" data-lang-key="modelSubtitle">Interact with the core spatial model. Input market data to dynamically calculate and visualize the RRA levels.</p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 md:gap-12">
                    <!-- Input Form -->
                    <div class="lg:col-span-1 bg-[var(--card-bg)] p-6 rounded-lg border border-[var(--border-color)]">
                        <h4 class="text-xl font-semibold mb-4" data-lang-key="modelInputTitle">Input Variables</h4>
                        <div class="space-y-4">
                            <div>
                                <label for="prev_high" class="block text-sm font-medium text-[var(--text-secondary)]" data-lang-key="inputPrevHigh">Previous High (Hp)</label>
                                <input type="number" id="prev_high" value="1.0780" step="0.0001" class="number-input mt-1 block w-full rounded-md border-[var(--border-color)] bg-[#0D1117] text-[var(--text-primary)] shadow-sm focus:border-[var(--accent-color)] focus:ring focus:ring-[var(--accent-color)] focus:ring-opacity-50 p-2">
                            </div>
                            <div>
                                <label for="prev_low" class="block text-sm font-medium text-[var(--text-secondary)]" data-lang-key="inputPrevLow">Previous Low (Lp)</label>
                                <input type="number" id="prev_low" value="1.0700" step="0.0001" class="number-input mt-1 block w-full rounded-md border-[var(--border-color)] bg-[#0D1117] text-[var(--text-primary)] shadow-sm focus:border-[var(--accent-color)] focus:ring focus:ring-[var(--accent-color)] focus:ring-opacity-50 p-2">
                            </div>
                            <div>
                                <label for="curr_high" class="block text-sm font-medium text-[var(--text-secondary)]" data-lang-key="inputCurrHigh">Current High (Hc)</label>
                                <input type="number" id="curr_high" value="1.0750" step="0.0001" class="number-input mt-1 block w-full rounded-md border-[var(--border-color)] bg-[#0D1117] text-[var(--text-primary)] shadow-sm focus:border-[var(--accent-color)] focus:ring focus:ring-[var(--accent-color)] focus:ring-opacity-50 p-2">
                            </div>
                            <div>
                                <label for="curr_low" class="block text-sm font-medium text-[var(--text-secondary)]" data-lang-key="inputCurrLow">Current Low (Lc)</label>
                                <input type="number" id="curr_low" value="1.0710" step="0.0001" class="number-input mt-1 block w-full rounded-md border-[var(--border-color)] bg-[#0D1117] text-[var(--text-primary)] shadow-sm focus:border-[var(--accent-color)] focus:ring focus:ring-[var(--accent-color)] focus:ring-opacity-50 p-2">
                            </div>
                        </div>
                        <div class="mt-6 border-t pt-4 border-[var(--border-color)]">
                             <h4 class="text-lg font-semibold mb-2" data-lang-key="modelCalcTitle">Core Calculations</h4>
                             <div class="text-sm space-y-2 text-[var(--text-secondary)]">
                                <p><strong data-lang-key="calcVu">Volatility Unit (Vu):</strong> <span id="vu_output">0.0080</span></p>
                                <p><strong data-lang-key="calcQv">25% Quantum (qv):</strong> <span id="qv_output">0.0020</span></p>
                             </div>
                        </div>
                    </div>
                    <!-- Chart & Output -->
                    <div class="lg:col-span-2 bg-[var(--card-bg)] p-6 rounded-lg border border-[var(--border-color)]">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="md:col-span-2">
                                <h4 class="text-xl font-semibold mb-4 text-center" data-lang-key="vizTitle">RRA Visualization</h4>
                                <div class="chart-container">
                                    <canvas id="rraChart"></canvas>
                                </div>
                            </div>
                            <div class="md:col-span-1">
                                <h4 class="text-xl font-semibold mb-4 text-center" data-lang-key="levelsTitle">Calculated Levels</h4>
                                <div id="levels-output" class="space-y-3 text-sm overflow-auto max-h-[450px] pr-2">
                                    <!-- Levels will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- The Synthesis Section -->
        <section id="synthesis" class="py-16 md:py-24 bg-[var(--card-bg)] border-y border-[var(--border-color)]">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h3 class="text-3xl font-bold" data-lang-key="synthesisTitle">The Synthesis: Price-Time Relativity</h3>
                    <p class="mt-2 text-[var(--text-secondary)]" data-lang-key="synthesisSubtitle">Understand how the spatial (RRA) and temporal (Chronos Cycles) dimensions merge to form predictive setups.</p>
                </div>
                <div id="synthesis-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                     <!-- Synthesis cards will be injected here -->
                </div>
            </div>
        </section>

        <!-- The Framework Section -->
        <section id="framework" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h3 class="text-3xl font-bold" data-lang-key="frameworkTitle">The Time Framework</h3>
                    <p class="mt-2 text-[var(--text-secondary)]" data-lang-key="frameworkSubtitle">Visualize the nested fractal structure of the Chronos Cycles hierarchy.</p>
                </div>
                <div id="framework-pyramid" class="max-w-3xl mx-auto flex flex-col items-center space-y-1">
                     <!-- Interactive Pyramid injected by JS -->
                </div>
                <div id="framework-description" class="max-w-3xl mx-auto mt-8 p-6 bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] min-h-[100px]">
                     <!-- Description injected by JS -->
                </div>
            </div>
        </section>
        
         <!-- Tools & Resources Section -->
        <section id="tools" class="py-16 md:py-24 bg-[var(--card-bg)] border-y border-[var(--border-color)]">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h3 class="text-3xl font-bold" data-lang-key="toolsTitle">Tools & Resources</h3>
                    <p class="mt-2 text-[var(--text-secondary)]" data-lang-key="toolsSubtitle">Practical tools and further reading to apply the RSA framework.</p>
                </div>
                <div id="resources-container" class="grid grid-cols-1 md:grid-cols-3 gap-8">
                     <!-- Tool Cards will be injected by JS -->
                </div>
            </div>
        </section>

        <!-- Download Whitepaper Section -->
        <section id="whitepaper" class="py-16 md:py-24">
            <div class="container mx-auto px-6 text-center">
                <h3 class="text-3xl font-bold" data-lang-key="downloadTitle">Download the Whitepaper</h3>
                <p class="mt-2 text-[var(--text-secondary)] max-w-2xl mx-auto" data-lang-key="downloadSubtitle">Access the complete technical document for an in-depth understanding of the Reflexive Symmetrical Architecture framework.</p>
                <div class="mt-8">
                    <a href="./RSA_Whitepaper.pdf" download="RSA_Whitepaper.pdf" class="inline-block bg-[var(--accent-color)] text-black font-bold py-3 px-8 rounded-md shadow-[0_0_15px_rgba(34,211,238,0.4)] hover:bg-[var(--accent-hover)] transition-all duration-300 transform hover:scale-105" data-lang-key="downloadBtn">
                        Download PDF
                    </a>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-black/20 text-[var(--text-secondary)]">
        <div class="container mx-auto px-6 py-8 text-center">
            <p>&copy; 2025 Adiyat Coto. All rights reserved.</p>
            <p class="text-sm mt-2" data-lang-key="footerText">An interactive interpretation of the "Reflexive Symmetrical Architecture" whitepaper.</p>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        const langData = {
            en: {
                navIntro: "Introduction",
                navTheory: "The Theory",
                navModel: "The Model",
                navSynthesis: "The Synthesis",
                navFramework: "Framework",
                navTools: "Tools",
                navWhitepaper: "Whitepaper",
                heroTitle: "Reflexive Symmetrical Architecture",
                heroSubtitle: "A unified theory of price-time, built on the first principle of recursive binary division.",
                heroAuthor: "By Adiyat Coto",
                introTitle: "An Introduction to RSA",
                introContent: `<div class="space-y-4">
                    <p><strong>What is RSA?</strong> RSA, or Reflexive Symmetrical Architecture, is a complete framework for market analysis. It unifies the study of price (space) and session structure (time) into a single, cohesive theory.</p>
                    <p><strong>Philosophical Background:</strong> The framework rejects static tools and views the market as a living, dynamic system. Its core philosophy is the "Axiom of Binary Division" — the idea that all market structures emerge from a simple, recursive division by two, reflecting a natural balance between opposing forces.</p>
                    <p><strong>Core Components:</strong>
                        <ul class="list-disc list-inside ml-4 mt-2">
                            <li><strong>RRA (Reflex Range Architecture):</strong> The spatial component. It maps *how far* price can potentially move by projecting symmetrical levels from the previous session's volatility.</li>
                            <li><strong>Chronos Cycles:</strong> The temporal component. It maps the *narrative flow* of a trading session by dividing it into four predictable phases, suggesting *when* certain behaviors are likely to occur.</li>
                        </ul>
                    </p>
                    <p><strong>What makes it unique?</strong> RSA's uniqueness lies in its dynamic, forward-looking nature. It uses only the most recent session's data (T-1) to project possibilities, making it highly adaptive to current market conditions, unlike lagging indicators that rely on extensive historical data.</p>
                </div>`,
                theoryTitle: "The Theory",
                theoryIntro: `<p class="mt-4 text-lg text-[var(--text-secondary)] max-w-3xl mx-auto">This section details the core components of the RSA framework. Explore each concept to understand the mechanics behind the model.</p>`,
                modelTitle: "The RRA Model",
                modelSubtitle: "Interact with the core spatial model. Input market data to dynamically calculate and visualize the RRA levels.",
                modelInputTitle: "Input Variables",
                inputPrevHigh: "Previous High (Hp)",
                inputPrevLow: "Previous Low (Lp)",
                inputCurrHigh: "Current High (Hc)",
                inputCurrLow: "Current Low (Lc)",
                modelCalcTitle: "Core Calculations",
                calcVu: "Volatility Unit (Vu):",
                calcQv: "25% Quantum (qv):",
                vizTitle: "RRA Visualization",
                levelsTitle: "Calculated Levels",
                synthesisTitle: "The Synthesis: Price-Time Relativity",
                synthesisSubtitle: "Understand how the spatial (RRA) and temporal (Chronos Cycles) dimensions merge to form predictive setups.",
                frameworkTitle: "The Time Framework",
                frameworkSubtitle: "Visualize the nested fractal structure of the Chronos Cycles hierarchy.",
                macroTitle: "Macro-Structure",
                macroContent: "Yearly, Semester, Quarterly, Monthly",
                mesoTitle: "Meso-Structure",
                mesoContent: "Weekly, Daily",
                microTitle: "Micro-Structure",
                microContent: "4-Hour, 1-Hour, 15-Min, 1-Min",
                macroDesc: "<strong>Purpose:</strong> To establish the long-term, dominant market trend and overall regime. RRA levels on these timeframes act as powerful gravitational fields that influence all smaller price movements. Analysis here prevents fighting the primary market tide.",
                mesoDesc: "<strong>Purpose:</strong> To define the tactical plan for the week or day. The weekly range sets the battlefield, while the daily chart reveals the specific struggles for key RRA levels within that context. This is the primary operational timeframe.",
                microDesc: "<strong>Purpose:</strong> For precise trade execution and management. This is the 'ground level' where the four phases of the Chronos Cycle become most apparent. Entries and exits are timed by observing price interaction with daily RRA levels within these intraday cycles.",
                frameworkDescDefault: "Click a structure level above to see its detailed purpose and context.",
                workflowTitle: "The Top-Down Analytical Workflow",
                step1Title: "Establish Macro Bias",
                step1Content: "Begin on the Macro-Structure to determine the primary trend. This establishes the context for all subsequent decisions.",
                step2Title: "Define Tactical Objectives",
                step2Content: "Move to the Meso-Structure (Daily) to identify key structural areas and define objectives in alignment with the macro bias.",
                step3Title: "Identify High-Probability Setups",
                step3Content: "Zoom into the Micro-Structure (4-Hour/1-Hour) to find locations where a Chronos Cycle aligns with an RRA level and the macro bias.",
                toolsTitle: "Tools & Resources",
                toolsSubtitle: "Practical tools and further reading to apply the RSA framework.",
                tool1Title: "Multi-Timeframe Analysis",
                tool1Desc: "An article explaining the core concept of using a top-down approach to establish directional bias, a foundational practice for RSA.",
                tool2Title: "Auto Residual Range Calculator",
                tool2Desc: "The official TradingView indicator that automatically calculates and displays the RRA levels on your chart.",
                tool3Title: "Multi-Timeframe Bias Analyzer",
                tool3Desc: "A companion TradingView tool to consolidate and visualize the directional bias across multiple timeframes at a glance.",
                readMore: "Read More",
                downloadTitle: "Download the Whitepaper",
                downloadSubtitle: "Access the complete technical document for an in-depth understanding of the Reflexive Symmetrical Architecture framework.",
                downloadBtn: "Download PDF",
                footerText: `An interactive interpretation of the "Reflexive Symmetrical Architecture" whitepaper.`,
                accordionData: [
                    { title: 'Core Terminology', content: `<ul><li class="mb-2"><strong>RSA (Reflexive Symmetrical Architecture):</strong> The complete, unified framework that combines both price and time analysis. It operates on the principle that the market is both reflexive (participant behavior influences outcomes) and symmetrical (movements balance around a central point).</li><li class="mb-2"><strong>RRA (Reflex Range Architecture):</strong> The <strong>spatial (price)</strong> component of RSA. It maps *how far* price can move by projecting symmetrical levels based on previous volatility.</li><li><strong>Chronos Cycles:</strong> The <strong>temporal (time)</strong> component of RSA. It maps the *narrative flow* of a session by dividing it into four predictable phases, suggesting *when* certain price actions are likely to occur.</li></ul>` },
                    { title: 'The Axiom of Binary Division', content: `The structural integrity of RSA rests upon a single, self-evident truth: The Axiom of Binary Division. This principle posits that any whole unit within a market context—be it of price potential or time duration—is subject to a natural, recursive division by two. This reflects the market's fundamental duality: buy vs. sell, expansion vs. contraction. Every complex market behavior is an emergent property of this irreducible, binary foundation.` },
                    { title: 'RRA Conceptual Foundations', content: `<ul class="list-disc list-inside space-y-2"><li><strong>Dynamic Equilibrium (EQ):</strong> The absolute center of the session's price field, calculated continuously as the arithmetic mean of the session's evolving high and low. It is the point of 'fair value' toward which price is perpetually drawn.</li><li><strong>Symmetrical Envelopes:</strong> Mirrored layers of potential energy (R-levels for resistance, S-levels for support) that expand from the EQ. They are not targets but energetic boundaries that define the probable limits of expansion and contraction.</li><li><strong>Spatial Memory:</strong> RRA posits that price-space holds memory. As price interacts with a level, it energizes that zone. Upon a retest, that zone will act as a high-probability reaction point, demonstrating structural polarity.</li></ul>` },
                    { title: 'Deeper Theoretical Foundations', content: `<div class="space-y-4"><div><h4 class="font-semibold text-[var(--text-primary)]">Parallels with Quantum Mechanics</h4><p>The concept of a 25% volatility quantum draws a parallel to the quantization of energy in physics. Just as energy in an atom exists in discrete levels, RSA posits that market volatility expresses itself in discrete, probabilistic packets. Price does not move smoothly; it "jumps" between these quantized volatility states.</p></div><div><h4 class="font-semibold text-[var(--text-primary)]">Information Theory Basis</h4><p>The framework's reliance on T-1 data (the previous session's range) assumes that the most recent data contains the maximum actionable information and the least noise. By intentionally limiting its "memory", RSA prioritizes signal over noise, creating a highly adaptive system.</p></div><div><h4 class="font-semibold text-[var(--text-primary)]">Complexity Science & Emergence</h4><p>RSA is an example of emergence, where simple, deterministic rules give rise to complex, unpredictable behavior. The framework models the underlying geometric and temporal constraints within which this complex behavior unfolds. The intricate patterns on a chart are an emergent property of these foundational rules.</p></div><div><h4 class="font-semibold text-[var(--text-primary)]">Market Ecology Perspective</h4><p>RSA treats the market as a natural ecological system. Its rules are derived from observation of the market's inherent properties—symmetry, fractal nature, and reflexive feedback loops. RRA and Chronos Cycles are maps of the natural laws governing energy flow in this financial ecosystem.</p></div></div>` }
                ],
                synthesisData: [
                    { title: 'The Spring-Coil', icon: '⧓', description: 'Price remains tightly range-bound between the R1 and S1 levels throughout the Early and Mid Phases. This failure to expand indicates a significant buildup of compressive energy, predicting a volatile, expansive breakout during the Late Phase.' },
                    { title: 'The Momentum Thrust', icon: '⭢', description: 'After establishing an anchor, price accelerates decisively through the R3/S3 level early in the Late Phase. This action confirms strong trend continuation and suggests market participants are targeting higher expansion levels with confidence.' },
                    { title: 'The Climactic Reversal', icon: '⥀', description: 'Price tags a major expansion level (e.g., R6) during the Final Phase. This represents a climactic, often exhaustive, move. It is a classic high-probability signal for a stall and a reversion trade back toward EQ.' }
                ],
                levelZoneExpansion: "Expansion Zone",
                levelZoneNeutral: "Neutral Zone",
                levelZoneContraction: "Contraction Zone",
                levelDescExpansion: "Represents trend enthusiasm and potential exhaustion.",
                levelDescNeutral: "A 1:1 extension of the prior session's energy.",
                levelDescContraction: "Represents indecision and energy consolidation.",
                chartLowLabel: "Current Low (Lc)",
                chartHighLabel: "Current High (Hc)",
            },
            id: {
                navIntro: "Pendahuluan",
                navTheory: "Teori",
                navModel: "Model",
                navSynthesis: "Sintesis",
                navFramework: "Kerangka Waktu",
                navTools: "Perangkat",
                navWhitepaper: "Dokumen Utama",
                heroTitle: "Arsitektur Simetris Refleksif",
                heroSubtitle: "Sebuah teori terpadu yang memetakan ruang dan waktu harga, dibangun di atas prinsip dasar pembagian biner yang terus berulang.",
                heroAuthor: "Oleh Adiyat Coto",
                introTitle: "Pengenalan RSA",
                introContent: `<div class="space-y-4">
                    <p><strong>Apa itu RSA?</strong> RSA, atau Arsitektur Simetris Refleksif, adalah sebuah kerangka kerja analisis pasar yang lengkap. Ini menyatukan studi tentang harga (ruang) dan struktur sesi (waktu) ke dalam satu teori yang utuh.</p>
                    <p><strong>Latar Belakang Filosofis:</strong> Kerangka kerja ini menolak perangkat statis dan memandang pasar sebagai sistem yang hidup dan dinamis. Filosofi intinya adalah "Aksioma Pembagian Biner"—gagasan bahwa semua struktur pasar muncul dari pembagian dua yang sederhana dan berulang, yang mencerminkan keseimbangan alami antara kekuatan yang berlawanan.</p>
                    <p><strong>Komponen Inti:</strong>
                        <ul class="list-disc list-inside ml-4 mt-2">
                            <li><strong>RRA (Arsitektur Rentang Refleksif):</strong> Komponen spasial. Ini memetakan *seberapa jauh* harga berpotensi bergerak dengan memproyeksikan level-level simetris berdasarkan volatilitas sesi sebelumnya.</li>
                            <li><strong>Siklus Chronos:</strong> Komponen temporal. Ini memetakan *alur cerita* sebuah sesi perdagangan dengan membaginya menjadi empat fase yang dapat diprediksi, memberi petunjuk *kapan* perilaku harga tertentu kemungkinan akan terjadi.</li>
                        </ul>
                    </p>
                    <p><strong>Apa yang membuatnya unik?</strong> Keunikan RSA terletak pada sifatnya yang dinamis dan berorientasi ke depan. Ia hanya menggunakan data sesi terbaru (T-1) untuk memproyeksikan kemungkinan, membuatnya sangat adaptif terhadap kondisi pasar saat ini, tidak seperti indikator yang lambat yang bergantung pada data historis yang luas.</p>
                </div>`,
                theoryTitle: "Teori",
                theoryIntro: `<p class="mt-4 text-lg text-[var(--text-secondary)] max-w-3xl mx-auto">Bagian ini mengupas fondasi konseptual dari kerangka kerja RSA. Ia menawarkan sudut pandang baru dalam membaca pasar — bukan sebagai rangkaian peristiwa acak, tetapi sebagai sistem yang memiliki struktur simetris dan refleksif secara alami. Di bawah ini, kita akan mengeksplorasi konsep-konsep inti yang menjadi dasar teoritis dari kerangka ini.</p>`,
                modelTitle: "Model RRA",
                modelSubtitle: "Jelajahi model spasial inti. Masukkan data pasar untuk menghitung dan melihat visualisasi level-level RRA secara dinamis.",
                modelInputTitle: "Variabel Input",
                inputPrevHigh: "Tertinggi Sebelumnya (Hp)",
                inputPrevLow: "Terendah Sebelumnya (Lp)",
                inputCurrHigh: "Tertinggi Saat Ini (Hc)",
                inputCurrLow: "Terendah Saat Ini (Lc)",
                modelCalcTitle: "Perhitungan Utama",
                calcVu: "Unit Volatilitas (Vu):",
                calcQv: "Kuantum 25% (qv):",
                vizTitle: "Visualisasi RRA",
                levelsTitle: "Level-Level Perhitungan",
                synthesisTitle: "Sintesis: Integrasi Ruang dan Waktu Harga",
                synthesisSubtitle: "Pahami bagaimana dimensi spasial (RRA) dan temporal (Chronos Cycles) berpadu untuk membentuk setup dengan probabilitas tinggi.",
                frameworkTitle: "Kerangka Waktu",
                frameworkSubtitle: "Visualisasi struktur bertingkat dari hierarki siklus waktu (Chronos Cycles).",
                macroTitle: "Struktur Makro",
                macroContent: "Tahunan, Semester, Kuartalan, Bulanan",
                mesoTitle: "Struktur Meso",
                mesoContent: "Mingguan, Harian",
                microTitle: "Struktur Mikro",
                microContent: "4-Jam, 1-Jam, 15-Menit, 1-Menit",
                macroDesc: "<strong>Tujuan:</strong> Untuk menetapkan tren pasar jangka panjang yang dominan dan rezim secara keseluruhan. Level RRA pada kerangka waktu ini bertindak sebagai medan gravitasi yang kuat yang mempengaruhi semua pergerakan harga yang lebih kecil. Analisis di sini mencegah perlawanan terhadap arus pasar utama.",
                mesoDesc: "<strong>Tujuan:</strong> Untuk menentukan rencana taktis selama seminggu atau sehari. Rentang mingguan menetapkan medan pertempuran, sementara grafik harian mengungkapkan perebutan spesifik untuk level RRA utama dalam konteks mingguan tersebut. Ini adalah kerangka waktu operasional utama.",
                microDesc: "<strong>Tujuan:</strong> Untuk eksekusi dan manajemen perdagangan yang presisi. Ini adalah 'level dasar' di mana empat fase Siklus Chronos menjadi paling jelas. Entri dan keluar diatur waktunya dengan mengamati interaksi harga dengan level RRA harian dalam siklus intraday ini.",
                frameworkDescDefault: "Klik level struktur di atas untuk melihat tujuan dan konteks rincinya.",
                workflowTitle: "Alur Analisis Top-Down",
                step1Title: "Tentukan Bias Makro",
                step1Content: "Mulailah dari struktur makro untuk menentukan arah tren utama. Ini akan menjadi konteks dari semua keputusan berikutnya.",
                step2Title: "Definisikan Objektif Taktis",
                step2Content: "Lanjut ke struktur meso (harian) untuk mengidentifikasi area-area penting dan menyelaraskan objektif dengan bias makro.",
                step3Title: "Temukan Setup Berkualitas Tinggi",
                step3Content: "Fokus ke struktur mikro (4-jam/1-jam) untuk menemukan zona di mana fase Chronos Cycle bertemu dengan level RRA dan bias makro.",
                toolsTitle: "Perangkat & Sumber Daya",
                toolsSubtitle: "Perangkat praktis dan bacaan lebih lanjut untuk menerapkan kerangka kerja RSA.",
                tool1Title: "Analisis Multi-Timeframe",
                tool1Desc: "Artikel yang menjelaskan konsep inti pendekatan top-down untuk menentukan bias arah, sebuah praktik dasar untuk RSA.",
                tool2Title: "Kalkulator Auto Residual Range",
                tool2Desc: "Indikator resmi untuk TradingView yang secara otomatis menghitung dan menampilkan level RRA pada grafik Anda.",
                tool3Title: "Penganalisis Bias Multi-Timeframe",
                tool3Desc: "Alat pendamping di TradingView untuk mengkonsolidasikan dan memvisualisasikan bias arah di berbagai kerangka waktu.",
                readMore: "Baca Selengkapnya",
                downloadTitle: "Unduh Whitepaper",
                downloadSubtitle: "Akses dokumen teknis lengkap untuk pemahaman menyeluruh tentang kerangka kerja Arsitektur Simetris Refleksif.",
                downloadBtn: "Unduh PDF",
                footerText: `Interpretasi interaktif dari whitepaper "Arsitektur Simetris Refleksif".`,
                accordionData: [
                    { title: "Terminologi Inti", content: `<ul><li class="mb-2"><strong>RSA (Arsitektur Simetris Refleksif):</strong> Adalah kerangka kerja utuh yang menyatukan analisis harga (ruang) dan waktu. RSA beroperasi pada prinsip bahwa pasar bersifat refleksif (perilaku partisipan mempengaruhi hasil) dan simetris (pergerakan harga seimbang di sekitar titik pusat).</li><li class="mb-2"><strong>RRA (Arsitektur Rentang Refleksif):</strong> Merupakan komponen <strong>spasial (harga)</strong> dari RSA. Fungsinya adalah memetakan *seberapa jauh* harga berpotensi bergerak dengan memproyeksikan level-level simetris berdasarkan volatilitas sebelumnya.</li><li><strong>Siklus Chronos:</strong> Merupakan komponen <strong>temporal (waktu)</strong> dari RSA. Fungsinya adalah memetakan *alur cerita* sebuah sesi dengan membaginya menjadi empat fase yang dapat diprediksi, menunjukkan *kapan* jenis pergerakan harga tertentu kemungkinan akan terjadi.</li></ul>` },
                    { title: "Aksioma Pembagian Biner", content: "Integritas struktural RSA bersandar pada satu kebenaran fundamental: Aksioma Pembagian Biner. Prinsip ini menyatakan bahwa setiap unit utuh dalam konteks pasar—baik itu potensi harga maupun durasi waktu—akan mengalami pembagian dua secara alami dan berulang. Hal ini mencerminkan dualitas pasar: beli vs. jual, ekspansi vs. kontraksi. Semua perilaku pasar yang kompleks pada dasarnya adalah hasil dari fondasi biner ini." },
                    { title: "Dasar Konseptual RRA", content: `<ul class="list-disc list-inside space-y-2"><li><strong>Keseimbangan Dinamis (EQ):</strong> Titik pusat absolut dari medan harga dalam satu sesi, dihitung secara real-time dari nilai tengah antara harga tertinggi dan terendah. Ini adalah representasi 'nilai wajar' di mana harga secara alami akan selalu tertarik kembali.</li><li><strong>Selubung Simetris (Symmetrical Envelopes):</strong> Lapisan-lapisan energi potensial yang terpantul secara simetris dari EQ (level R untuk resistansi, level S untuk support). Ini bukanlah target harga, melainkan batas-batas energi yang mendefinisikan kemungkinan jangkauan ekspansi dan kontraksi.</li><li><strong>Memori Spasial:</strong> RRA berasumsi bahwa ruang harga memiliki memori. Ketika harga berinteraksi dengan sebuah level R atau S, zona tersebut menjadi signifikan secara struktural. Saat diuji kembali di masa depan, zona tersebut memiliki probabilitas tinggi untuk menjadi titik reaksi (support menjadi resistansi, atau sebaliknya), yang menunjukkan adanya prinsip polaritas.</li></ul>` },
                    { title: "Fondasi Teoretis Mendalam", content: `<div class="space-y-4"><div><h4 class="font-semibold text-[var(--text-primary)]">Paralel dengan Mekanika Kuantum</h4><p>Konsep kuantum volatilitas 25% sejajar dengan kuantisasi energi dalam fisika. Seperti halnya energi dalam atom yang ada pada level diskrit, RSA menyatakan bahwa volatilitas pasar diekspresikan dalam paket-paket probabilistik yang diskrit. Harga tidak bergerak mulus; ia "melompat" di antara keadaan volatilitas terkuantisasi ini.</p></div><div><h4 class="font-semibold text-[var(--text-primary)]">Dasar Teori Informasi</h4><p>Ketergantungan kerangka kerja pada data T-1 (rentang sesi sebelumnya) mengasumsikan bahwa data terbaru mengandung informasi yang paling dapat ditindaklanjuti dan paling sedikit noise. Dengan sengaja membatasi "memorinya", RSA memprioritaskan sinyal daripada noise, menciptakan sistem yang sangat adaptif.</p></div><div><h4 class="font-semibold text-[var(--text-primary)]">Ilmu Kompleksitas & Kemunculan</h4><p>RSA adalah contoh kemunculan (emergence), di mana aturan-aturan sederhana dan deterministik menimbulkan perilaku yang kompleks dan tidak terduga. Kerangka kerja ini memodelkan batasan geometris dan temporal yang mendasari di mana perilaku kompleks ini terjadi. Pola rumit pada grafik adalah properti yang muncul dari aturan-aturan dasar ini.</p></div><div><h4 class="font-semibold text-[var(--text-primary)]">Perspektif Ekologi Pasar</h4><p>RSA memperlakukan pasar sebagai sistem ekologis alami. Aturannya berasal dari pengamatan properti inheren pasar—simetri, sifat fraktal, dan loop umpan balik refleksif. RRA dan Siklus Chronos adalah peta hukum alam yang mengatur aliran energi dalam ekosistem keuangan ini.</p></div></div>` }
                ],
                synthesisData: [
                    { title: "Koil Pegas", icon: '⧓', description: "Harga bergerak dalam rentang sempit antara level R1 dan S1 selama Fase Awal dan Pengembangan. Kegagalan harga untuk berekspansi menandakan adanya penumpukan energi, yang berpotensi memicu breakout yang kuat pada Fase Akselerasi." },
                    { title: "Dorongan Momentum", icon: '⭢', description: "Setelah jangkar terbentuk, harga menembus level R3/S3 secara meyakinkan pada awal Fase Akselerasi. Aksi ini mengkonfirmasi kelanjutan tren yang kuat dan mengindikasikan bahwa pelaku pasar menargetkan level ekspansi yang lebih tinggi." },
                    { title: "Pembalikan Klimaks", icon: '⥀', description: "Harga menyentuh level ekspansi mayor (misalnya R6) selama Fase Resolusi. Ini menandakan sebuah pergerakan klimaks yang seringkali bersifat jenuh. Ini adalah sinyal klasik dengan probabilitas tinggi untuk terjadinya pembalikan arah kembali menuju EQ." }
                ],
                levelZoneExpansion: "Zona Ekspansi",
                levelZoneNeutral: "Zona Netral",
                levelZoneContraction: "Zona Kontraksi",
                levelDescExpansion: "Menandakan antusiasme tren dan potensi kejenuhan.",
                levelDescNeutral: "Mencerminkan perpanjangan energi 1:1 dari sesi sebelumnya.",
                levelDescContraction: "Menandakan keraguan pasar dan konsolidasi energi.",
                chartLowLabel: "Terendah Saat Ini (Lc)",
                chartHighLabel: "Tertinggi Saat Ini (Hc)",
            }
        };
        
        const accordionContainer = document.getElementById('accordion-container');
        const synthesisContainer = document.getElementById('synthesis-container');
        const resourcesContainer = document.getElementById('resources-container');
        const inputs = ['prev_high', 'prev_low', 'curr_high', 'curr_low'];
        const inputElements = inputs.map(id => document.getElementById(id));
        const vuOutput = document.getElementById('vu_output');
        const qvOutput = document.getElementById('qv_output');
        const levelsOutput = document.getElementById('levels-output');
        let rraChart;
        let currentLang = localStorage.getItem('lang') || 'en';

        function getPrecision(value) {
            const sValue = String(value);
            return sValue.includes('.') ? sValue.split('.')[1].length : 0;
        }

        const calculateRRA = () => {
            const [hp, lp, hc, lc] = inputElements.map(el => parseFloat(el.value));
            if ([hp, lp, hc, lc].some(isNaN)) return null;
            const vu = hp - lp;
            const qv = 0.25 * vu;
            const levels = { EQ: (hc + lc) / 2 };
            const multipliers = { R1: 0.50, S1: 0.50, R2: 0.75, S2: 0.75, R3: 1.00, S3: 1.00, R4: 1.25, S4: 1.25, R5: 1.50, S5: 1.50, R6: 2.00, S6: 2.00, R7: 3.00, S7: 3.00, R8: 4.00, S8: 4.00 };
            for (const [key, mult] of Object.entries(multipliers)) {
                levels[key] = key.startsWith('R') ? lc + mult * vu : hc - mult * vu;
            }
            return { vu, qv, levels, hc, lc };
        };
        
        const renderLevel = (key, value, type, precision) => {
            const colors = { R: 'text-red-400', S: 'text-green-400', EQ: 'text-[var(--accent-color)] font-bold' };
            return `<div class="flex justify-between items-center font-mono ${colors[type]}"><span>${key}</span><span>${value.toFixed(precision)}</span></div>`;
        };

        const updateUI = (data) => {
            if (!data) return;
            const { levels } = data;
            const precision = Math.max(getPrecision(inputElements[0].value), 5);
            
            vuOutput.textContent = data.vu.toFixed(precision);
            qvOutput.textContent = data.qv.toFixed(precision);

            const sortedR = ['R8','R7','R6','R5','R4'];
            const sortedS = ['S4','S5','S6','S7','S8'];
            const neutralR = ['R3'];
            const neutralS = ['S3'];
            const contractR = ['R2','R1'];
            const contractS = ['S1','S2'];

            const translations = langData[currentLang];

            levelsOutput.innerHTML = `
                <div class="mb-4">
                    <h5 class="font-bold text-[var(--text-primary)]">${translations.levelZoneExpansion}</h5>
                    <p class="text-xs text-[var(--text-secondary)] pb-1">${translations.levelDescExpansion}</p>
                    ${sortedR.map(k => renderLevel(k, levels[k], 'R', precision)).join('')}
                </div>
                <div class="mb-4">
                    <h5 class="font-bold text-[var(--text-primary)]">${translations.levelZoneNeutral}</h5>
                    <p class="text-xs text-[var(--text-secondary)] pb-1">${translations.levelDescNeutral}</p>
                     ${neutralR.map(k => renderLevel(k, levels[k], 'R', precision)).join('')}
                     ${renderLevel('EQ', levels.EQ, 'EQ', precision)}
                     ${neutralS.map(k => renderLevel(k, levels[k], 'S', precision)).join('')}
                </div>
                <div class="mb-4">
                    <h5 class="font-bold text-[var(--text-primary)]">${translations.levelZoneContraction}</h5>
                    <p class="text-xs text-[var(--text-secondary)] pb-1">${translations.levelDescContraction}</p>
                    ${contractR.map(k => renderLevel(k, levels[k], 'R', precision)).join('')}
                    ${contractS.map(k => renderLevel(k, levels[k], 'S', precision)).join('')}
                </div>
                 <div class="mb-4">
                    <h5 class="font-bold text-[var(--text-primary)]">${translations.levelZoneExpansion}</h5>
                    <p class="text-xs text-[var(--text-secondary)] pb-1">${translations.levelDescExpansion}</p>
                    ${sortedS.map(k => renderLevel(k, levels[k], 'S', precision)).join('')}
                </div>
            `;
        };

        const renderChart = (data) => {
            if (!data) return;
            const { levels, hc, lc } = data;
            const ctx = document.getElementById('rraChart').getContext('2d');
            
            const levelColors = { R: 'rgba(239, 68, 68, 0.5)', S: 'rgba(34, 197, 94, 0.5)', EQ: 'rgba(34, 211, 238, 1)' };
            const pointColors = { high: 'rgba(239, 68, 68, 1)', low: 'rgba(34, 197, 94, 1)' };
            const labelColors = { R: '#f87171', S: '#4ade80', EQ: '#67e8f9' };
            
            const annotations = {};
            const percentages = { R1: '50%', S1: '50%', R2: '75%', S2: '75%', R3: '100%', S3: '100%', R4: '125%', S4: '125%', R5: '150%', S5: '150%', R6: '200%', S6: '200%', R7: '300%', S7: '300%', R8: '400%', S8: '400%'};

            const precision = Math.max(getPrecision(inputElements[0].value), 5);

            Object.entries(levels).forEach(([key, value]) => {
                const type = key.startsWith('R') ? 'R' : (key.startsWith('S') ? 'S' : 'EQ');
                
                let borderDash;
                if (key === 'EQ') borderDash = [6, 6];
                else if (key.includes('1') || key.includes('2')) borderDash = [2, 2]; // Contraction - dotted
                else if (key.includes('3')) borderDash = [10, 5]; // Neutral - dashed
                else borderDash = []; // Expansion - solid
                
                annotations[key] = {
                    type: 'line', yMin: value, yMax: value, borderColor: levelColors[type],
                    borderWidth: key === 'EQ' ? 2 : 1.5,
                    borderDash: borderDash,
                    label: {
                        enabled: true,
                        content: `${key} ${percentages[key] || ''} (${value.toFixed(precision)})`,
                        position: 'end', 
                        textAlign: 'right',
                        backgroundColor: 'rgba(13, 17, 23, 0.75)',
                        font: { size: 10, weight: '500', family: 'Roboto Mono' },
                        color: labelColors[type], 
                        padding: 4,
                        xAdjust: -10,
                    }
                };
            });

            const translations = langData[currentLang];
            const chartData = {
                labels: ['Anchor Points'],
                datasets: [
                    { label: translations.chartLowLabel, data: [{ x: 0.5, y: lc }], pointBackgroundColor: pointColors.low, pointBorderColor: '#0D1117', pointBorderWidth: 2, pointRadius: 8, pointHoverRadius: 10 },
                    { label: translations.chartHighLabel, data: [{ x: 0.5, y: hc }], pointBackgroundColor: pointColors.high, pointBorderColor: '#0D1117', pointBorderWidth: 2, pointRadius: 8, pointHoverRadius: 10 }
                ]
            };
            
            const allValues = Object.values(levels);
            const maxLevel = Math.max(...allValues);
            const minLevel = Math.min(...allValues);
            const padding = (maxLevel - minLevel) * 0.15;

            const scalesOptions = {
                y: { min: minLevel - padding, max: maxLevel + padding, grid: { color: 'rgba(139, 148, 158, 0.2)' }, ticks: { color: '#8B949E' } },
                x: { display: false }
            };

            if (rraChart) {
                rraChart.data = chartData;
                rraChart.options.plugins.annotation.annotations = annotations;
                rraChart.options.scales = scalesOptions;
                rraChart.options.plugins.tooltip.callbacks.label = (context) => ` ${context.dataset.label}: ${context.parsed.y}`;
                rraChart.update();
            } else {
                rraChart = new Chart(ctx, {
                    type: 'scatter', data: chartData,
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        scales: scalesOptions,
                        plugins: {
                            legend: { display: false },
                            annotation: { annotations: annotations },
                            tooltip: { callbacks: { label: (context) => ` ${context.dataset.label}: ${context.parsed.y}` } }
                        }
                    }
                });
            }
        };
        
        const handleModelUpdate = () => {
            const data = calculateRRA();
            if(data) {
                updateUI(data);
                renderChart(data);
            }
        };
        
        const updateLanguage = (lang) => {
            currentLang = lang;
            localStorage.setItem('lang', lang);

            document.documentElement.lang = lang;

            const translations = langData[lang];
            document.querySelectorAll('[data-lang-key]').forEach(el => {
                const key = el.getAttribute('data-lang-key');
                if (translations[key]) {
                    el.innerHTML = translations[key];
                }
            });
            
            const mobileNav = document.getElementById('mobile-nav');
            const currentHash = window.location.hash || '#introduction';
            mobileNav.innerHTML = `
                <option value="#introduction">${translations.navIntro}</option>
                <option value="#theory">${translations.navTheory}</option>
                <option value="#model">${translations.navModel}</option>
                <option value="#synthesis">${translations.navSynthesis}</option>
                <option value="#framework">${translations.navFramework}</option>
                 <option value="#tools">${translations.navTools}</option>
                <option value="#whitepaper">${translations.navWhitepaper}</option>
            `;
            mobileNav.value = currentHash;


            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
            });
            
            accordionContainer.innerHTML = '';
            translations.accordionData.forEach((item) => {
                const div = document.createElement('div');
                div.className = 'bg-[var(--card-bg)] border border-[var(--border-color)] rounded-lg';
                div.innerHTML = `<button class="accordion-toggle w-full flex justify-between items-center p-4 text-left font-semibold hover:text-[var(--accent-color)]"><span>${item.title}</span><svg class="accordion-arrow w-5 h-5 transform transition-transform text-[var(--text-secondary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button><div class="accordion-content px-4 text-[var(--text-secondary)]"><div class="border-t border-[var(--border-color)] pt-4 pb-4">${item.content}</div></div>`;
                accordionContainer.appendChild(div);
            });

            synthesisContainer.innerHTML = '';
            translations.synthesisData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'bg-[var(--card-bg)] p-6 rounded-lg border border-[var(--border-color)] text-center';
                card.innerHTML = `<div class="text-5xl text-[var(--accent-color)] mb-4">${item.icon}</div><h3 class="text-xl font-semibold mb-2">${item.title}</h3><p class="text-[var(--text-secondary)]">${item.description}</p>`;
                synthesisContainer.appendChild(card);
            });

             resourcesContainer.innerHTML = '';
            const resourcesData = [
                { link: 'https://medium.com/@coto.adiyat/multi-timeframe-analysis-on-stocks-and-currencies-market-532d99e3eac5' },
                { link: 'https://medium.com/@coto.adiyat/auto-residual-range-calculator-for-tradingview-ce8bfdbd5ad2' },
                { link: 'https://medium.com/@coto.adiyat/the-multi-timeframe-bias-analyzer-8d5916d940a3' }
            ];
            resourcesData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'bg-[var(--card-bg)] p-6 rounded-lg border border-[var(--border-color)] flex flex-col';
                card.innerHTML = `
                    <h3 class="text-xl font-semibold mb-2">${translations[`tool${index+1}Title`]}</h3>
                    <p class="text-[var(--text-secondary)] flex-grow">${translations[`tool${index+1}Desc`]}</p>
                    <a href="${item.link}" target="_blank" rel="noopener noreferrer" class="mt-4 inline-block text-center bg-[var(--accent-color)] text-black font-bold py-2 px-4 rounded-md hover:bg-[var(--accent-hover)] transition-colors">${translations.readMore}</a>
                `;
                resourcesContainer.appendChild(card);
            });
            
            const frameworkPyramid = document.getElementById('framework-pyramid');
            const frameworkDesc = document.getElementById('framework-description');
            
            frameworkPyramid.innerHTML = `
                <button class="structure-btn bg-[var(--card-bg)] border-2 border-[var(--border-color)] p-4 rounded-lg w-full md:w-5/6 text-center transition-all" data-structure="macro">
                    <h4 class="font-semibold text-lg" data-lang-key="macroTitle">${translations.macroTitle}</h4>
                    <p class="text-sm text-[var(--text-secondary)]" data-lang-key="macroContent">${translations.macroContent}</p>
                </button>
                 <button class="structure-btn bg-[var(--card-bg)] border-2 border-[var(--border-color)] p-4 w-full md:w-2/3 text-center transition-all" data-structure="meso">
                    <h4 class="font-bold text-lg" data-lang-key="mesoTitle">${translations.mesoTitle}</h4>
                    <p class="text-sm text-[var(--text-secondary)]" data-lang-key="mesoContent">${translations.mesoContent}</p>
                </button>
                 <button class="structure-btn bg-[var(--card-bg)] border-2 border-[var(--border-color)] p-4 rounded-lg w-full md:w-1/2 text-center transition-all" data-structure="micro">
                    <h4 class="font-semibold text-lg" data-lang-key="microTitle">${translations.microTitle}</h4>
                    <p class="text-sm text-[var(--text-secondary)]" data-lang-key="microContent">${translations.microContent}</p>
                </button>
            `;
            frameworkDesc.innerHTML = `<p class="text-center text-[var(--text-secondary)] italic">${translations.frameworkDescDefault}</p>`;

            frameworkPyramid.addEventListener('click', (e) => {
                const btn = e.target.closest('.structure-btn');
                if (btn) {
                    const structureType = btn.dataset.structure;
                    document.querySelectorAll('.structure-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    frameworkDesc.innerHTML = `<p>${translations[`${structureType}Desc`]}</p>`;
                }
            });

            handleModelUpdate();
        };
        
        // --- Initializations & Event Listeners ---
        inputElements.forEach(el => el.addEventListener('input', handleModelUpdate));

        accordionContainer.addEventListener('click', (e) => {
            const toggle = e.target.closest('.accordion-toggle');
            if (!toggle) return;
            const content = toggle.nextElementSibling;
            const icon = toggle.querySelector('svg');
            const isOpening = !content.style.maxHeight || content.style.maxHeight === '0px';

            document.querySelectorAll('#accordion-container .accordion-content').forEach(c => {
                c.style.maxHeight = '0px';
                c.previousElementSibling.querySelector('svg').classList.remove('rotate-180');
            });

            if (isOpening) {
                content.style.maxHeight = content.scrollHeight + 'px';
                icon.classList.add('rotate-180');
            }
        });

        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('main section');
        window.addEventListener('scroll', () => {
            let current = 'hero';
            sections.forEach(section => {
                if (section.id && pageYOffset >= section.offsetTop - 80) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
            const mobileNav = document.getElementById('mobile-nav');
            if (mobileNav) {
                let targetValue = `#${current}`;
                if(current === 'hero') targetValue = '#introduction';
                const targetOption = mobileNav.querySelector(`option[value="${targetValue}"]`);
                if (targetOption) {
                    mobileNav.value = targetValue;
                }
            }
        });
        
        const mobileNavEl = document.getElementById('mobile-nav');
        if (mobileNavEl) {
            mobileNavEl.addEventListener('change', (e) => {
                const target = document.querySelector(e.target.value);
                if(target) window.scrollTo({ top: target.offsetTop - 70, behavior: 'smooth'});
            });
        }
        
        const downloadBtnEl = document.getElementById('download-btn');
        if(downloadBtnEl) {
            downloadBtnEl.addEventListener('click', (e) => {
                // The preventDefault is removed to allow the download attribute to work.
                // alert('PDF download functionality would be implemented here.');
            });
        }
        
        const langSwitcherDesktop = document.getElementById('lang-switcher');
        if (langSwitcherDesktop) {
            langSwitcherDesktop.addEventListener('click', (e) => {
                if(e.target.matches('.lang-btn')) updateLanguage(e.target.getAttribute('data-lang'));
            });
        }
        
        const langSwitcherMobile = document.getElementById('lang-switcher-mobile');
        if (langSwitcherMobile) {
            langSwitcherMobile.addEventListener('click', (e) => {
                if(e.target.matches('.lang-btn')) updateLanguage(e.target.getAttribute('data-lang'));
            });
        }

        // Initial Call
        updateLanguage(currentLang);
    });
    </script>
</body>
</html>

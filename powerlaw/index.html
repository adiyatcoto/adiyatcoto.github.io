<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Law Generator | Auto slope and R² confidence detection</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-pure: #000000;
            --accent: #fbce03;
            --up: #10b981;
            --down: #f43f5e;
            --grid-line: #000000; 
        }

        html, body {
            background-color: #000000 !important;
            color: #f8fafc; 
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        /* Styling Grid - Tetap Hitam untuk OLED Look */
        .grid line { stroke: var(--grid-line); stroke-opacity: 1; shape-rendering: crispEdges; }
        .grid path { stroke-width: 0; }
        .axis-label { font-size: 10px; fill: #475569; font-family: 'JetBrains Mono', monospace; }
        
        /* Candlestick Styling */
        .candle-up { fill: var(--up); stroke: var(--up); stroke-width: 0.5; }
        .candle-down { fill: var(--down); stroke: var(--down); stroke-width: 0.5; }
        .wick { stroke: #1e293b; stroke-width: 0.8; }
        
        /* Power Law Main Line - Tanpa Glow, Lebih Ringan */
        .regression-line { 
            stroke: var(--accent); 
            stroke-width: 3.5; 
            fill: none; 
            pointer-events: visibleStroke;
            transition: stroke-width 0.1s ease-out;
        }

        /* Deviation Bands - Optimasi Opacity */
        .band-line { 
            stroke-width: 1.2; 
            fill: none; 
            pointer-events: none; 
            transition: stroke-width 0.1s ease-out, stroke-opacity 0.1s ease-out;
        }

        /* Hitbox interaksi - menjaga performa tetap stabil */
        .line-hitbox {
            fill: none;
            stroke: transparent;
            stroke-width: 20;
            cursor: crosshair;
            pointer-events: visibleStroke;
        }
        
        .chart-svg { cursor: crosshair; user-select: none; background-color: #000000 !important; }
        
        /* Tooltip - GPU Accelerated */
        .tooltip {
            position: absolute;
            pointer-events: none;
            background: rgba(10, 10, 10, 0.98);
            border: 1px solid #1e293b;
            padding: 12px;
            border-radius: 4px;
            font-size: 11px;
            display: none;
            z-index: 100;
            font-family: 'JetBrains Mono', monospace;
            box-shadow: 0 10px 25px rgba(0,0,0,1);
            transform: translateZ(0);
        }

        .header-ui { 
            background: #000000 !important; 
            border-bottom: 1px solid #0f172a; 
        }
        
        .stat-card {
            background: #050505;
            border: 1px solid #1e293b;
            padding: 6px 14px;
            border-radius: 4px;
            min-width: 150px;
        }

        .chart-area-clip { clip-path: url(#clip); }

        #autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #050505;
            border: 1px solid #1e293b;
            z-index: 1000;
            max-height: 250px;
            overflow-y: auto;
            display: none;
        }

        .suggestion-item {
            padding: 10px 14px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #111827;
        }
        .suggestion-item:hover { background: #111827; }
    </style>
</head>
<body>

    <!-- Header Section -->
    <header class="h-24 header-ui flex items-center justify-between px-10 relative z-20">
        <div class="flex items-center space-x-8">
            <div class="flex flex-col">
                <h1 class="text-xl font-black text-white italic tracking-tighter uppercase leading-tight">
                    <span class="text-yellow-500">POWER LAW GENERATOR</span>
                </h1>
                <p class="text-[9px] text-slate-700 font-mono tracking-widest uppercase italic">Auto slope and R² confidence detection</p>
            </div>
            
            <div class="flex flex-col space-y-1">
                <div class="relative flex items-center bg-black rounded-lg border border-slate-900 group focus-within:border-yellow-500 transition-all">
                    <div class="p-1.5 flex items-center space-x-2">
                        <input id="tickerInput" type="text" value="BTC" autocomplete="off" class="bg-transparent border-none px-3 py-1 text-xs focus:outline-none uppercase w-24 font-bold text-yellow-500" placeholder="Ticker...">
                        <button id="updateBtn" class="bg-yellow-600 hover:bg-yellow-500 text-black px-6 py-2 rounded text-[10px] font-black transition-all uppercase">
                            Sync
                        </button>
                    </div>
                    <div id="autocomplete-list" class="rounded-b-lg shadow-2xl"></div>
                </div>
            </div>
        </div>

        <div class="flex space-x-4">
            <div class="stat-card flex flex-col items-end">
                <span class="text-[8px] text-slate-600 font-bold uppercase tracking-widest leading-none mb-1">Growth Slope (m)</span>
                <span id="slopeVal" class="text-yellow-500 font-mono text-lg font-bold">0.0000</span>
                <span class="text-[7px] text-slate-500 font-mono italic text-right">Linear regression slope</span>
            </div>
            <div class="stat-card flex flex-col items-end">
                <span class="text-[8px] text-slate-600 font-bold uppercase tracking-widest leading-none mb-1">R² Confidence</span>
                <span id="r2Val" class="text-emerald-500 font-mono text-lg font-bold">0.0000</span>
                <span class="text-[7px] text-slate-500 font-mono italic text-right">Coefficient of determination</span>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="relative w-full h-[calc(100vh-96px)] bg-black">
        <div id="chart-container" class="w-full h-full"></div>
        <div id="tooltip" class="tooltip"></div>
        
        <!-- Interactive Legend -->
        <div class="absolute top-6 left-10 p-4 bg-black/90 rounded-lg border border-slate-900 pointer-events-none flex flex-col space-y-1.5 z-10 shadow-2xl backdrop-blur-sm min-w-[210px]">
            <div class="text-[9px] font-black text-slate-500 tracking-[0.2em] mb-2 uppercase border-b border-slate-800 pb-1">Deviation Corridors</div>
            
            <div class="flex items-center justify-between text-[9px] font-bold">
                <div class="flex items-center space-x-3">
                    <div class="w-3 h-1 bg-[#ff1e56] rounded-full"></div>
                    <span class="text-[#ff1e56]">CYCLE PEAK</span>
                </div>
                <span class="text-slate-600">+2.0σ</span>
            </div>
            <div class="flex items-center justify-between text-[9px] font-medium">
                <div class="flex items-center space-x-3">
                    <div class="w-3 h-[1px] bg-[#ffac41] border-t border-dashed border-[#ffac41]"></div>
                    <span class="text-orange-400">EXTREME HEAT</span>
                </div>
                <span class="text-slate-600">+1.5σ</span>
            </div>
            <div class="flex items-center justify-between text-[9px] font-medium">
                <div class="flex items-center space-x-3">
                    <div class="w-3 h-[1px] bg-[#fffb7d] border-t border-dashed border-[#fffb7d]"></div>
                    <span class="text-yellow-100">OVERBOUGHT</span>
                </div>
                <span class="text-slate-600">+1.0σ</span>
            </div>
            <div class="flex items-center justify-between text-[10px] font-black my-1 border-y border-slate-900 py-1">
                <div class="flex items-center space-x-3">
                    <div class="w-4 h-1.5 bg-[#fbce03] rounded-full"></div>
                    <span class="text-yellow-400 font-bold uppercase">Fair Value (Mean)</span>
                </div>
                <span class="text-yellow-600">0σ</span>
            </div>
            <div class="flex items-center justify-between text-[9px] font-medium">
                <div class="flex items-center space-x-3">
                    <div class="w-3 h-[1px] bg-[#a3f7bf] border-t border-dashed border-[#a3f7bf]"></div>
                    <span class="text-emerald-300">ACCUMULATION</span>
                </div>
                <span class="text-slate-600">-1.0σ</span>
            </div>
            <div class="flex items-center justify-between text-[9px] font-medium">
                <div class="flex items-center space-x-3">
                    <div class="w-3 h-[1px] bg-[#2de1fc] border-t border-dashed border-[#2de1fc]"></div>
                    <span class="text-cyan-400">DEEP VALUE AREA</span>
                </div>
                <span class="text-slate-600">-1.5σ</span>
            </div>
            <div class="flex items-center justify-between text-[9px] font-bold">
                <div class="flex items-center space-x-3">
                    <div class="w-3 h-1 bg-[#2164f3] rounded-full"></div>
                    <span class="text-[#2164f3]">GENERATIONAL BOTTOM</span>
                </div>
                <span class="text-slate-600">-2.0σ</span>
            </div>
        </div>

        <!-- Copyright Info -->
        <div class="absolute bottom-3 w-full text-center text-[9px] text-slate-900 font-mono tracking-[0.3em] pointer-events-none z-30 uppercase">
            © 2026 Adiyat Coto
        </div>

        <!-- App Loader -->
        <div id="loader" class="absolute inset-0 bg-black flex items-center justify-center z-50">
            <div class="flex flex-col items-center">
                <div class="w-10 h-10 border-2 border-yellow-500/10 border-t-yellow-500 rounded-full animate-spin"></div>
                <p class="mt-4 text-slate-800 text-[9px] font-bold uppercase tracking-[0.3em] font-mono">Calibrating engine...</p>
            </div>
        </div>
    </main>

    <script>
        /**
         * POWER LAW GENERATOR ENGINE (V4.0 ULTRA-LIGHT)
         */

        const GENESIS_BLOCK_TIMESTAMP = 1230940800; 
        const SECONDS_IN_DAY = 86400;
        const HARDCODED_API_KEY = "kucd5ccf2da23b5b008ee549b281c29ec08fd342b5a6bc99e206dfa4bbee162431";

        const container = d3.select("#chart-container");
        const tooltip = d3.select("#tooltip");
        const tickerInput = document.getElementById('tickerInput');
        const autocompleteList = document.getElementById('autocomplete-list');
        
        let svg, width, height, xScale, yScale, xAxis, yAxis, gX, gY, chartArea;
        let originalXScale, originalYScale;
        let globalData = [], regressionMeta = {};
        let topAssets = []; 
        let currentAnchorTime = GENESIS_BLOCK_TIMESTAMP;
        
        const margin = { top: 40, right: 90, bottom: 60, left: 20 };

        const BANDS_CONFIG = [
            { dev: 2.0, color: '#ff1e56', opacity: 0.8, dash: 'none', weight: 2, label: 'Cycle Peak' }, 
            { dev: 1.5, color: '#ffac41', opacity: 0.5, dash: '6,4', weight: 1, label: 'Extreme Heat' },   
            { dev: 1.0, color: '#fffb7d', opacity: 0.5, dash: '4,4', weight: 1, label: 'Overbought' }, 
            { dev: 0.5, color: '#fbce03', opacity: 0.15, dash: '2,4', weight: 0.8, label: 'Bullish Buffer' }, 
            { dev: -0.5, color: '#fbce03', opacity: 0.15, dash: '2,4', weight: 0.8, label: 'Bearish Buffer' },
            { dev: -1.0, color: '#a3f7bf', opacity: 0.5, dash: '4,4', weight: 1, label: 'Accumulation' }, 
            { dev: -1.5, color: '#2de1fc', opacity: 0.5, dash: '6,4', weight: 1, label: 'Deep Value' },   
            { dev: -2.0, color: '#2164f3', opacity: 0.8, dash: 'none', weight: 2, label: 'Generational Bottom' }  
        ];

        async function fetchAutocompleteData() {
            try {
                const res = await fetch(`https://min-api.cryptocompare.com/data/top/mktcapfull?limit=100&tsym=USD&api_key=${HARDCODED_API_KEY}`);
                const json = await res.json();
                if (json.Data) {
                    topAssets = json.Data.map(item => ({
                        symbol: item.CoinInfo.Name,
                        fullName: item.CoinInfo.FullName
                    }));
                }
            } catch (e) { console.error("Error fetching coins."); }
        }

        tickerInput.addEventListener('input', () => {
            const val = tickerInput.value.toUpperCase();
            autocompleteList.innerHTML = '';
            if (!val) { autocompleteList.style.display = 'none'; return; }
            const filtered = topAssets.filter(a => a.symbol.includes(val) || a.fullName.toUpperCase().includes(val)).slice(0, 10);
            if (filtered.length > 0) {
                autocompleteList.style.display = 'block';
                filtered.forEach(asset => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `<span class="text-yellow-500 font-bold">${asset.symbol}</span> <span class="text-slate-500 text-[10px]">${asset.fullName}</span>`;
                    div.onclick = () => {
                        tickerInput.value = asset.symbol;
                        autocompleteList.style.display = 'none';
                        setupCanvas();
                        analyze(asset.symbol);
                    };
                    autocompleteList.appendChild(div);
                });
            } else { autocompleteList.style.display = 'none'; }
        });

        document.addEventListener('click', (e) => {
            if (e.target !== tickerInput) autocompleteList.style.display = 'none';
        });

        function setupCanvas() {
            container.selectAll("*").remove();
            const rect = container.node().getBoundingClientRect();
            width = rect.width - margin.left - margin.right;
            height = rect.height - margin.top - margin.bottom;

            svg = container.append("svg")
                .attr("width", rect.width)
                .attr("height", rect.height)
                .attr("class", "chart-svg")
                .style("background-color", "#000000");

            svg.append("rect").attr("width", rect.width).attr("height", rect.height).attr("fill", "#000000");
            svg.append("defs").append("clipPath").attr("id", "clip").append("rect").attr("width", width).attr("height", height);
            
            const mainGroup = svg.append("g").attr("transform", `translate(${margin.left},${margin.top})`);
            gX = mainGroup.append("g").attr("class", "grid axis-label").attr("transform", `translate(0,${height})`);
            gY = mainGroup.append("g").attr("class", "grid axis-label").attr("transform", `translate(${width}, 0)`);
            chartArea = mainGroup.append("g").attr("class", "chart-area-clip");
            
            const zoom = d3.zoom().scaleExtent([0.01, 20000]).on("zoom", zoomed);
            svg.call(zoom);
        }

        function calculateRegression(data) {
            const n = data.length;
            let sumX = 0, sumY = 0, sumXY = 0, sumXX = 0, sumYY = 0;
            data.forEach(d => {
                const lnX = Math.log(d.days);
                const lnY = Math.log(d.close);
                sumX += lnX; sumY += lnY;
                sumXY += lnX * lnY;
                sumXX += lnX * lnX;
                sumYY += lnY * lnY;
            });
            const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
            const intercept = (sumY - slope * sumX) / n;
            const r = (n * sumXY - sumX * sumY) / Math.sqrt((n * sumXX - sumX * sumX) * (n * sumYY - sumY * sumY));
            const residuals = data.map(d => Math.log(d.close) - (slope * Math.log(d.days) + intercept));
            const stdDev = Math.sqrt(residuals.map(r => r * r).reduce((a, b) => a + b) / n);
            return { slope, intercept, r2: r * r, stdDev };
        }

        // Lightweight Hover Function (No Filters)
        function handleLineHover(event, d, isMean = false, index = null) {
            const [mx, my] = d3.pointer(event, chartArea.node());
            const days = xScale.invert(mx);
            const dev = isMean ? 0 : d.dev;
            const label = isMean ? 'Fair Value (Mean)' : d.label;
            const color = isMean ? '#fbce03' : d.color;
            
            const price = Math.exp(regressionMeta.slope * Math.log(days) + regressionMeta.intercept + (dev * regressionMeta.stdDev));
            const date = new Date(currentAnchorTime * 1000);
            date.setDate(date.getDate() + days);

            tooltip.style("display", "block").html(`
                <div class="text-[10px] font-black uppercase mb-1" style="color: ${color}">${label}</div>
                <div class="border-t border-slate-800 pt-1.5 mt-1.5 grid grid-cols-2 gap-x-4 gap-y-1 text-[10px]">
                    <span class="text-slate-500 uppercase font-mono">Date:</span> <span>${date.toLocaleDateString('en-US', {year:'numeric', month:'short', day:'numeric'})}</span>
                    <span class="text-slate-500 uppercase font-mono">Price:</span> <span class="text-white font-bold font-mono">$${price.toLocaleString(undefined, {maximumFractionDigits: 2})}</span>
                    <span class="text-slate-500 uppercase font-mono">Sigma:</span> <span>${dev.toFixed(1)}σ</span>
                </div>
            `);
            tooltip.style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 15) + "px");

            // Simplified visual feedback
            if (isMean) {
                chartArea.select(".regression-line").style("stroke-width", "5px");
            } else if (index !== null) {
                chartArea.select(`.band-line-${index}`)
                    .style("stroke-opacity", "1.0")
                    .style("stroke-width", (d.weight + 2) + "px");
            }
        }

        function removeGlow(index = null) {
            tooltip.style("display", "none");
            if (index === null) {
                chartArea.select(".regression-line").style("stroke-width", "3.5px");
            } else {
                const b = BANDS_CONFIG[index];
                chartArea.select(`.band-line-${index}`)
                    .style("stroke-opacity", b.opacity)
                    .style("stroke-width", b.weight + "px");
            }
        }

        function updateElements(currXScale, currYScale) {
            xScale = currXScale;
            yScale = currYScale;
            gX.call(xAxis.scale(currXScale));
            gY.call(yAxis.scale(currYScale));

            const minD = currXScale.domain()[0];
            const maxD = currXScale.domain()[1];
            const xRange = d3.range(Math.log(Math.max(0.1, minD)), Math.log(maxD), (Math.log(maxD) - Math.log(Math.max(0.1, minD)))/250).map(Math.exp);

            const lineGen = d3.line().x(d => currXScale(d));

            chartArea.select(".regression-line")
                .attr("d", lineGen.y(d => currYScale(Math.exp(regressionMeta.slope * Math.log(d) + regressionMeta.intercept)))(xRange));

            BANDS_CONFIG.forEach((b, i) => {
                const pathData = lineGen.y(d => currYScale(Math.exp(regressionMeta.slope * Math.log(d) + regressionMeta.intercept + (b.dev * regressionMeta.stdDev))))(xRange);
                chartArea.select(`.band-line-${i}`).attr("d", pathData);
                chartArea.select(`.hitbox-${i}`).attr("d", pathData);
            });

            const candles = chartArea.selectAll(".candle-group");
            candles.select(".wick").attr("x1", d => currXScale(d.days)).attr("x2", d => currXScale(d.days)).attr("y1", d => currYScale(d.high)).attr("y2", d => currYScale(d.low));
            candles.select("rect").attr("x", d => currXScale(d.days) - 1.25).attr("y", d => currYScale(Math.max(d.open, d.close))).attr("height", d => Math.max(0.6, Math.abs(currYScale(d.open) - currYScale(d.close))));
        }

        function zoomed(event) {
            updateElements(event.transform.rescaleX(originalXScale), event.transform.rescaleY(originalYScale));
        }

        async function analyze(symbol) {
            d3.select("#loader").style("display", "flex");
            
            try {
                const response = await fetch(`https://min-api.cryptocompare.com/data/v2/histoday?fsym=${symbol.toUpperCase()}&tsym=USD&allData=true&api_key=${HARDCODED_API_KEY}`);
                const json = await response.json();
                if (json.Response === "Error") throw new Error(json.Message);
                const rawData = json.Data.Data.filter(d => d.close > 0);
                const firstTimestamp = rawData[0].time;
                currentAnchorTime = symbol.toUpperCase() === 'BTC' ? GENESIS_BLOCK_TIMESTAMP : firstTimestamp;

                globalData = rawData.map(d => ({
                    ...d,
                    days: Math.max(1, (d.time - currentAnchorTime) / SECONDS_IN_DAY),
                    date: new Date(d.time * 1000)
                }));

                regressionMeta = calculateRegression(globalData);
                d3.select("#slopeVal").text(regressionMeta.slope.toFixed(4));
                d3.select("#r2Val").text(regressionMeta.r2.toFixed(4));

                originalXScale = d3.scaleLog().domain([d3.min(globalData, d => d.days), d3.max(globalData, d => d.days) * 3]).range([0, width]);
                originalYScale = d3.scaleLog().domain([d3.min(globalData, d => d.low) * 0.4, d3.max(globalData, d => d.high) * 12]).range([height, 0]);

                xScale = originalXScale;
                yScale = originalYScale;

                xAxis = d3.axisBottom(originalXScale).ticks(10).tickFormat(d => {
                    const date = new Date(currentAnchorTime * 1000);
                    date.setDate(date.getDate() + d);
                    return date.getFullYear();
                }).tickSize(-height);

                yAxis = d3.axisRight(originalYScale).ticks(15, d => {
                    if (d >= 1000000) return "$" + (d/1000000).toLocaleString() + "M";
                    if (d >= 1000) return "$" + (d/1000).toLocaleString() + "k";
                    if (d >= 1) return "$" + d.toLocaleString();
                    return "$" + d.toFixed(3);
                }).tickSize(-width);

                chartArea.selectAll("*").remove();

                BANDS_CONFIG.forEach((b, i) => {
                    chartArea.append("path")
                        .attr("class", `band-line band-line-${i}`)
                        .attr("stroke", b.color)
                        .attr("stroke-opacity", b.opacity)
                        .attr("stroke-width", b.weight);
                    if (b.dash !== 'none') {
                        chartArea.select(`.band-line-${i}`).attr("stroke-dasharray", b.dash);
                    }

                    chartArea.append("path")
                        .attr("class", `line-hitbox hitbox-${i}`)
                        .on("mouseover", (e) => handleLineHover(e, b, false, i))
                        .on("mousemove", (e) => handleLineHover(e, b, false, i))
                        .on("mouseout", () => removeGlow(i));
                });

                chartArea.append("path")
                    .attr("class", "regression-line")
                    .on("mouseover", (e) => handleLineHover(e, null, true))
                    .on("mousemove", (e) => handleLineHover(e, null, true))
                    .on("mouseout", () => removeGlow());

                const candleGroups = chartArea.selectAll(".candle-group").data(globalData).enter().append("g").attr("class", "candle-group");
                candleGroups.append("line").attr("class", "wick");
                candleGroups.append("rect").attr("width", 2.5).attr("class", d => d.close >= d.open ? "candle-up" : "candle-down")
                    .on("mouseover", (e, d) => {
                        const dev = (Math.log(d.close) - (regressionMeta.slope * Math.log(d.days) + regressionMeta.intercept)) / regressionMeta.stdDev;
                        tooltip.style("display", "block").html(`
                            <div class="text-white font-bold border-b border-slate-900 pb-1.5 mb-2 font-mono">${d.date.toLocaleDateString('en-US', {year:'numeric', month:'short', day:'numeric'})}</div>
                            <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-[10px] font-mono">
                                <span class="text-slate-500 uppercase">Price:</span> <span class="text-yellow-500 font-bold">$${d.close.toLocaleString()}</span>
                                <span class="text-slate-500 uppercase">Age:</span> <span>${Math.floor(d.days)} d</span>
                                <span class="text-slate-500 uppercase">Dev:</span> <span style="color: ${dev > 0 ? '#ff1e56' : '#2de1fc'}" class="font-bold">${dev.toFixed(3)}σ</span>
                                <span class="text-slate-500 uppercase">Zone:</span> <span class="text-slate-300 italic">
                                    ${dev > 1.8 ? 'Peak' : dev > 1.3 ? 'Extreme' : dev > 0.8 ? 'Overbought' : dev > -0.8 ? 'Fair' : dev > -1.3 ? 'Accumulate' : dev > -1.8 ? 'Deep Value' : 'Bottom'}
                                </span>
                            </div>
                        `);
                    })
                    .on("mousemove", (e) => tooltip.style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 15) + "px"))
                    .on("mouseout", () => tooltip.style("display", "none"));

                updateElements(originalXScale, originalYScale);
            } catch (err) { console.error(err); }
            finally { d3.select("#loader").style("display", "none"); }
        }

        window.onload = () => { setupCanvas(); fetchAutocompleteData(); analyze("BTC"); };
        window.onresize = () => { setupCanvas(); analyze(tickerInput.value); };
        d3.select("#updateBtn").on("click", () => { setupCanvas(); analyze(tickerInput.value); });
    </script>
</body>
</html>